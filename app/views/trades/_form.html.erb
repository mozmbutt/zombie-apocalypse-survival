<%= form_with(model: trade) do |form| %>
  <% if trade.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(trade.errors.count, "error") %> prohibited this trade from being saved:</h2>
      <ul>
        <% trade.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form.hidden_field :base_trader_id, value:current_user.id %>
  <%= form.hidden_field :trader_id, value:@trader.id %>

  <div class="container h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-lg-12 col-xl-11">
        <div class="card text-black" style="border-radius: 25px;">
          <div class="card-body p-md-5">
            <div class="row justify-content-center">
              <div class="pricing-header p-3 pb-md-4 mx-auto text-center">
                <h1 class="display-4 fw-normal">Select your Inventory</h1>
              </div>
              <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
                <% @base_trader_inventories.each do |inventory| %>
                  <%= form.fields_for :trade_histories, trade.trade_histories.build do |th_fields| %>
                    <%= inventory.item.name %> ( <%= inventory.item.points %> points )
                    <%= th_fields.number_field :quantity, :min => 0, :max => inventory.stock, class:"form-control" %>
                    You have <%= inventory.stock %> in stock 
                    <%= th_fields.hidden_field :item_id, value:inventory.item.id %>
                    <%= th_fields.hidden_field :user_id, value:current_user.id %>
                    <br>
                    <br>
                  <% end %>    
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-lg-12 col-xl-11">
        <div class="card text-black" style="border-radius: 25px;">
          <div class="card-body p-md-5">
            <div class="row justify-content-center">
              <div class="pricing-header p-3 pb-md-4 mx-auto text-center">
                <h1 class="display-4 fw-normal">Select <%= @trader.name %>'s Inventory</h1>
              </div>
              <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
                <% @trader_inventories.each do |inventory| %>
                  <%= form.fields_for :trade_histories, trade.trade_histories.build do |th_fields| %>
                    <%= inventory.item.name %> ( <%= inventory.item.points %> points ) 
                    <%= th_fields.number_field :quantity, :min => 0, :max => inventory.stock, class:"form-control" %>
                    They have <%= inventory.stock %> in stock 
                    <%= th_fields.hidden_field :item_id, value:inventory.item.id %>
                    <%= th_fields.hidden_field :user_id, value:@trader.id %>
                    <br>
                    <br>
                  <% end %>    
                <% end %>
              </div>
            </div>
          </div>
          <div class="actions">
            <%= form.submit 'Send Offer', class:"btn btn-success form-control btn-lg" %>
          </div>
        </div>
        
      </div>
      
    </div>
     
  </div>
<% end %>
